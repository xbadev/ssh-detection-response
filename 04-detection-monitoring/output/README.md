# Detection Output

This directory contains the runtime output files generated by the SSH brute-force detection script.

These files are excluded from version control via `.gitignore` because they represent **dynamic runtime state** that changes with each script execution and should not be committed to the repository.

---

## Output Files

### `alerts.log`

**Purpose:** Records all detected brute-force attempts with timestamp and source IP information.

**Format:**
```
[ALERT] 192.168.56.30 | count=5 | from=2026-01-16 10:12:13.177062+00:00 | to=2026-01-16 10:12:15.974722+00:00
```

**Contents:**
- Source IP address of attacker
- Number of failed authentication attempts detected
- Time window of attack activity (first and last failed attempt timestamps)

**Usage:**
- Provides human-readable log of security events
- Can be parsed by automated response systems (Phase 05)
- Serves as audit trail of detected attacks

---

### `state.json`

**Purpose:** Maintains persistent tracking of failed login attempts per IP address across script executions.

**Format:**
```json
{
  "ips": {
    "192.168.56.30": {
      "last_alert_end": "2026-01-16T10:12:15.974722+00:00"
    }
  }
}
```

**Contents:**
- Mapping of IP addresses to their last alert timestamp
- Enables deduplication (prevents alerting on the same attack window multiple times)
- Tracks state between detection runs

**Usage:**
- Prevents duplicate alerts for the same attack sequence
- Maintains detection context across systemd service restarts
- Enables stateful monitoring despite periodic script execution

---

## Why `.gitignore`?

These files are excluded from version control because:

**Runtime Data vs. Code**
- These files contain **live operational data**, not source code or configuration
- They change constantly during normal script operation
- Their content is specific to a single environment and testing session

**Environment-Specific**
- Alert logs and state are unique to each lab instance
- Committing them would pollute the repository with local runtime artifacts
- Other users cloning the repo should generate their own alerts/state

**Security Considerations**
- Alert logs may contain IP addresses from real security events
- State files track ongoing attack patterns
- These should remain local to the monitoring environment

**Best Practice**
- Source code and configuration belong in version control
- Runtime output and state files do not
- This separation keeps the repository clean and focused on reproducible infrastructure

---

## File Generation

Both files are automatically created by the detection script on first execution:

- **`alerts.log`** is appended to each time a new brute-force source is detected
- **`state.json`** is updated after each script run to track alert history

If deleted, the script will regenerate them on next execution with fresh state.
